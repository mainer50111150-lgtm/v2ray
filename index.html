<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ú©Ø§Ù†ÙÛŒÚ¯ Ø±Ø§ÛŒÚ¯Ø§Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
<style>
body {
    font-family: Tahoma;
    background:#2e2e2e;
    color:#fff;
    margin:0;
    padding:20px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.container {
    max-width:600px;
    width: 100%;
    margin:auto;
    background:#444;
    padding:25px;
    border-radius:12px;
    text-align:center;
    box-shadow:0 0 20px #000;
}

h1 { color:#4fc3f7; margin-bottom: 25px; }

.button-group {
    display: flex;
    flex-wrap: wrap;
    gap:10px;
    justify-content: center;
    margin-top: 20px;
}

/* Ø¯Ú©Ù…Ù‡ Ø¨Ø²Ø±Ú¯ ÙˆØ³Ø· ØµÙØ­Ù‡ Ø§Ù…Ø§ Ø¬Ù…Ø¹ Ùˆ Ø¬ÙˆØ± */
#one {
    width: 30%;
    padding: 18px;
    font-size: 20px;
    border-radius: 10px;
    background: #4caf50;
    color: #fff;
    cursor: pointer;
    margin-bottom: 15px;
    transition: transform 0.2s, background 0.2s;
}

#one:hover {
    background: #45a049;
    transform: scale(1.05);
}

/* Ø¨Ù‚ÛŒÙ‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ú©ÙˆÚ†Ú©â€ŒØªØ± Ùˆ Ù¾Ø§ÛŒÛŒÙ† */
.btn {
    width: 48%;
    padding:12px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    background:#2196f3;
    color:#fff;
    font-size:15px;
    transition: transform 0.2s, background 0.2s;
}

.btn:hover { 
    background:#1976d2;
    transform: scale(1.05);
}

.red{ background:#f44336; }
.support{ background:#25d366; }
.support:hover{ background:#1da851; }

#msg {
    display:none;
    margin-top:15px;
    padding:10px;
    border-radius:6px;
    font-weight:bold;
}

.footer {
    margin-top:20px;
    font-size:14px;
    color:#ccc;
    text-align: center;
    font-weight: bold;
}
</style>
</head>
<body>

    <!-- Modal Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù…ØªÙ† Ú©Ù¾ÛŒ -->
<div id="copyModal" style="
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.6);
    justify-content:center;
    align-items:center;
    z-index:99999;
">
    <div style="
        background:#fff;
        color:#000;
        padding:20px;
        border-radius:10px;
        max-width:400px;
        width:90%;
        text-align:center;
        position:relative;
    ">
        <h3>Ú©Ø§Ù†ÙÛŒÚ¯ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡</h3>
        <textarea id="modalText" style="width:100%; height:120px; margin-top:10px; font-family:monospace; font-size:14px;" readonly></textarea>
        <div style="margin-top:15px;">
            <button id="modalCopy" style="padding:10px 20px; background:#4caf50; color:#fff; border:none; border-radius:5px; cursor:pointer;">Ú©Ù¾ÛŒ Ø¨Ù‡ Ú©Ù„ÛŒÙ¾â€ŒØ¨ÙˆØ±Ø¯</button>
            <button id="modalClose" style="padding:10px 20px; background:#f44336; color:#fff; border:none; border-radius:5px; cursor:pointer;">Ø¨Ø³ØªÙ†</button>
        </div>
    </div>
</div>

<div class="container">
<h1>Ú©Ø§Ù†ÙÛŒÚ¯ Ø±Ø§ÛŒÚ¯Ø§Ù†ğŸ“¡</h1>

<div class="info">
ğŸ“¡ ØªØ¹Ø¯Ø§Ø¯: <span id="count">0</span> | â° Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: <span id="time">---</span>
</div>

<!-- Ø¯Ú©Ù…Ù‡ Ø¬Ù…Ø¹ Ùˆ Ø¬ÙˆØ± ÙˆØ³Ø· ØµÙØ­Ù‡ -->
<button id="one">Ú©Ù¾ÛŒ ØªØµØ§Ø¯ÙÛŒ 1ï¸âƒ£</button>

<!-- Ø¨Ù‚ÛŒÙ‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ -->
<div class="button-group">
<button class="btn green" id="refresh">ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ</button>
<button class="btn support" id="support">ğŸ’¬ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ„Ú¯Ø±Ø§Ù…</button>
<button class="btn red" id="clear">ğŸ—‘ï¸ Ø­Ø°Ù Ú©Ø´</button>
</div>

<div id="msg"></div>

<div class="footer" style="color: #000; background-color: #1976d2; border-radius: 5px; padding-bottom: 5px;">
Ù†Ú©ØªÙ‡: Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ Ø¯ÙˆÙ†Ù‡â€ŒØ¯ÙˆÙ†Ù‡ Ùˆ ØªØµØ§Ø¯ÙÛŒ Ú©Ù¾ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯<br>Ø¢Ø®Ø±ÛŒÙ† Ø®Ø·ÙˆØ· ÙØ§ÛŒÙ„ Ø¯Ø± Ø§ÙˆÙ„ÙˆÛŒØª Ù‡Ø³ØªÙ†Ø¯
</div>
</div>

<script>
// --- Ø§ÛŒÙ†Ø¬Ø§ Ú©Ø¯Ù‡Ø§ÛŒ JS Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ Ø±Ø§ Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ ---
const URL = "https://raw.githubusercontent.com/SoliSpirit/v2ray-configs/main/Countries/Us.txt";
const CACHE = "VLESS_CACHE_PRO";
const TIME = 30 * 60 * 1000;
let configs = [];

// Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…
function show(text,color){
    let m = document.getElementById("msg");
    m.innerText = text;
    m.style.background = color;
    m.style.display = "block";
    setTimeout(()=>{ m.style.display="none"; },3000);
}

// Ú©Ø´
function save(){
    localStorage.setItem(CACHE,JSON.stringify({time:Date.now(),list:configs}));
}
function loadCache(){
    let c = localStorage.getItem(CACHE);
    if(!c) return false;
    let data = JSON.parse(c);
    if(Date.now()-data.time > TIME) return false;
    configs = data.list;
    updateUI(data.time);
    show("âš¡ Ø§Ø² Ú©Ø´ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯","#4caf50");
    return true;
}

// Ø¯Ø±ÛŒØ§ÙØª ÙØ§ÛŒÙ„
async function fetchData(){
    show("â³ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...","#ff9800");
    try{
        let res = await fetch(URL);
        if(!res.ok) throw "error";
        let text = await res.text();
        configs = text.split("\n")
            .map(l => l.trim())
            .filter(l => l.length>0 && /^(vless|vmess|trojan|ss):\/\//i.test(l));
        save();
        updateUI(Date.now());
        show("âœ… Ù…ÙˆÙÙ‚: "+configs.length,"#4caf50");
    }catch{
        show("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„","#f44336");
    }
}

// Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
function updateUI(t){
    document.getElementById("count").innerText=configs.length;
    document.getElementById("time").innerText=new Date(t).toLocaleString("fa-IR");
}

// Ø§Ù†ØªØ®Ø§Ø¨ ØªØµØ§Ø¯ÙÛŒ Ø§Ø² Ù¾Ø§ÛŒÛŒÙ† ÙØ§ÛŒÙ„ (Ø¢Ø®Ø±ÛŒÙ† 100 Ø®Ø·)
function pickRandomFromBottom() {
    if (!configs.length) {
        show("âŒ Ù„ÛŒØ³Øª Ø®Ø§Ù„ÛŒ Ø§Ø³Øª","#f44336");
        return null;
    }
    // ØªØºÛŒÛŒØ± Ø¹Ø¯Ø¯ 20 Ø¨Ù‡ 100
    const bottomLines = configs.slice(-100);
    const randomIndex = Math.floor(Math.random() * bottomLines.length);
    return bottomLines[randomIndex];
}
function pickFromBottomToTop() {
    if (!configs.length) {
        show("âŒ Ù„ÛŒØ³Øª Ø®Ø§Ù„ÛŒ Ø§Ø³Øª","#f44336");
        return null;
    }

    // Ø§Ú¯Ø± Ù‡Ù†ÙˆØ² Ø´Ø±ÙˆØ¹ Ù†Ú©Ø±Ø¯ÛŒÙ…ØŒ Ø§Ø² Ø¢Ø®Ø±ÛŒÙ† Ø®Ø· Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ…
    if (currentIndex === -1) {
        currentIndex = configs.length - 1;
    } else {
        currentIndex--; // Ø­Ø±Ú©Øª Ø¨Ù‡ Ø³Ù…Øª Ø¨Ø§Ù„Ø§ÛŒ ÙØ§ÛŒÙ„
    }

    if (currentIndex < 0) {
        show("âš ï¸ ØªÙ…Ø§Ù… Ø®Ø·ÙˆØ· Ú©Ù¾ÛŒ Ø´Ø¯Ù†Ø¯","#ff9800");
        return null; // ÙˆÙ‚ØªÛŒ ØªÙ…Ø§Ù… Ø®Ø·ÙˆØ· Ú©Ù¾ÛŒ Ø´Ø¯Ù†Ø¯
    }

    return configs[currentIndex];
}


// Ú©Ù¾ÛŒ Ø¯ÙˆÙ†Ù‡â€ŒØ§ÛŒ
function copyOne(){
    let cfg = pickFromBottomToTop();
    if(!cfg) return;

    // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Modal
    const modal = document.getElementById("copyModal");
    const modalText = document.getElementById("modalText");
    modalText.value = cfg;
    modal.style.display = "flex";

    // Ø¯Ú©Ù…Ù‡ Ú©Ù¾ÛŒ Ø¯Ø§Ø®Ù„ Modal
    document.getElementById("modalCopy").onclick = () => {
        navigator.clipboard.writeText(cfg)
            .then(()=> show("âœ… Ú©Ù¾ÛŒ Ø´Ø¯","#4caf50"))
            .catch(()=> show("âŒ Ú©Ù¾ÛŒ Ù†Ø´Ø¯","#f44336"));
    };

    // Ø¯Ú©Ù…Ù‡ Ø¨Ø³ØªÙ† Modal
    document.getElementById("modalClose").onclick = () => {
        modal.style.display = "none";
    };

    // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Modal Ù‡Ù… Ø¨Ø¨Ù†Ø¯Ø¯
    modal.onclick = (e) => {
        if(e.target === modal) modal.style.display = "none";
    };
}
let currentIndex = -1; // Ø´Ø±ÙˆØ¹ Ø§Ø² Ù¾Ø§ÛŒÛŒÙ† ÙØ§ÛŒÙ„ (Ø¢Ø®Ø±ÛŒÙ† Ø®Ø·)



// Ø´Ø±ÙˆØ¹
document.addEventListener("DOMContentLoaded",()=>{
    if(!loadCache()) fetchData();
    document.getElementById("refresh").onclick=fetchData;
    document.getElementById("clear").onclick=()=>{ localStorage.removeItem(CACHE); show("ğŸ—‘ï¸ Ú©Ø´ Ø­Ø°Ù Ø´Ø¯","#2196f3"); };
    document.getElementById("one").onclick=copyOne;
    document.getElementById("support").onclick=()=>{ window.open("https://t.me/BTC_ETH_DOG_SOL","_blank"); };
});
</script>


</body>
</html>
